@using ActiveCareForms

@model CambianKPI.DAL.ViewModels.KpiExcelSSDataVM
@{
    ViewBag.Title = "From Spreadsheet";
}



<h2>KPI Excel Spreadsheet Upload</h2>
<input type="hidden" value="@ViewBag.SiteID" id="SiteID" />

    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"> </script>
    <script type="text/javascript" src="@Url.ContentWithTimestamp("/Scripts/Cambian.FakeAjax.js")"> </script>
    <!-- <script type="text/javascript">
        $(function () {
            var config = {
                urls: {
                    "/KpiScore/Save": [{ SiteID: 1, KpiMeasureID: 3, WeekEndingDate: Date.parse("2014-05-30"), Value: 3 }, { SiteID: 1, KpiMeasureID: 5, WeekEndingDate: Date.parse("2014-05-30"), Value: 5}],
                    "/KpiScore/Approve": []
                }
            };
            $.fakeajax(config);
        });
    </script>-->


<div id="lightbox-overlay"></div>
<div class="lightbox-content">
    <div class="lightbox-inner">
        <label>Please Enter Number</label>
        <span id="incorrect-input-format-note">You have not entered the data correctly.</span>
        <input type="text" id="resultNumber" />
        <button class="enter">ENTER</button>
        <button class="close">X</button>
    </div>
</div>

<div id="comment-popup">
    <div class="lightbox-inner">
        <button class="close">X</button>
        <h5>COMMENTS : Manager</h5>
        <textarea></textarea>
        <button class="enter">ENTER COMMENT</button>
    </div>
</div>
<div id="container" class="spreadsheet-upload">
    <div id="main-inner" style="margin-bottom: 50px;">

        <div class="main-content-wrap">
            @if (ViewBag.fileError != string.Empty || ViewBag.fileErrorArray.Count > 0)
            {
                <div class="error_div" style="display: block;">
                    @if (ViewBag.fileError != string.Empty)
                    {
                        <p>@ViewBag.fileError</p>
                    }
                    @if (ViewBag.fileErrorArray.Count > 0)
                    {
                        <p>Not all of the data in the Spreadsheet was valid, and so not all of it has been saved. Please see below for a list of errors/exceptions:</p>
                        <ul>
                            @{
                        System.Collections.ArrayList ErrorArray = (System.Collections.ArrayList)(ViewBag.fileErrorArray);
                        foreach (string stringLine in ErrorArray)
                        {
                                    <li>@stringLine</li>
                        }
                            }
                        </ul>
                        <p>If you wish, you can ammend the errors/exceptions and re-upload the Spreadsheet.</p>
                    }
                </div>
            }
            else if (ViewBag.fileSuccess != string.Empty)
            {
                <div class="success_div" style="display:block;">@ViewBag.fileSuccess</div>
            }
            <div class="list-content-div weekly-rota">
                <ul class="list-content">
                    <li>
                        <div class="label-wrapper">Please Upload this week's Excel Spreadsheet</div>

                    </li>
                </ul>
            </div>
             
            <div class="list-content-div">
                @using (Html.BeginForm("KpiExcelImport", "Site", FormMethod.Post, new { enctype = "multipart/form-data" }))
                {
                    <fieldset>
                        <dl>
                            <dd><input type="file" name="mainFile" id="main-file" /></dd>

                            <dd id="submitdd"><input type="submit" value="Upload" /></dd>
                        </dl>
                    </fieldset>
                }
            </div>

    </div>

        <div class="main-content-wrap">

    </div>
</div>
    

<script type="text/javascript" src="@Url.ContentWithTimestamp("/Scripts/date-en-GB.js")"></script>
<script type="text/javascript" src="@Url.ContentWithTimestamp("/Scripts/CambianKpi.KpiEntry.js")"></script><!-- NEW -->
<script type="text/javascript" src="@Url.ContentWithTimestamp("/Scripts/Tipsy.js")"></script>

<!-- END NEW -->
<script type='text/javascript'>
    $(function () {

        $('.kpi-score[data-uneditable="calc"], .kpi-score[data-uneditable="central"], .kpi-score[data-uneditable="approved"]').tipsy();

    });
</script>